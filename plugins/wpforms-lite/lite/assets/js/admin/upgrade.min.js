"use strict";var WPFormsUpgrade=window.WPFormsUpgrade||function(e,r,t){var n={$licenseKey:t("#wpforms-settings-upgrade-license-key"),$licenseKeySpinner:t("#wpforms-settings-upgrade-license-key ~ .wpforms-spinner"),$licenseKeyCont:t("#wpforms-settings-upgrade-license-key-cont"),$upgradeBtn:t("#wpforms-settings-upgrade-btn")},o={init:function(){t(e).ready(o.ready)},ready:function(){o.displayForm(),o.events()},displayForm:function(){""===n.$licenseKey.val()?n.$licenseKeyCont.removeClass("wpforms-hide"):n.$upgradeBtn.removeClass("wpforms-hide")},events:function(){o.licenseEvent(),o.upgradeBtnClick()},licenseEvent:function(){var e=null;n.$licenseKey.on("input",function(){null!==e&&clearTimeout(e),e=setTimeout(function(){o.licenseVerify()},500)})},upgradeBtnClick:function(){n.$upgradeBtn.on("click",function(){t.alert(o.licenseVerifySuccess())})},licenseVerify:function(){var e={action:"wpforms_verify_license",nonce:wpforms_admin.nonce,license:n.$licenseKey.val()};""!==e.license&&(n.$licenseKeySpinner.removeClass("wpforms-hide"),t.post(wpforms_admin.ajax_url,e).done(function(e){var n;n=e.success?o.licenseVerifySuccess(e):o.licenseVerifyError(e),t.alert(n)}).fail(function(e){o.failAlert(e)}).always(function(e){n.$licenseKeySpinner.addClass("wpforms-hide")}))},licenseVerifySuccess:function(e){var n={confirm:{text:wpforms_upgrade.upgrd_to_pro_btn_upgrade,btnClass:"btn-confirm",keys:["enter"],action:function(){o.gotoUpgradeUrl()}},cancel:{text:wpforms_upgrade.upgrd_to_pro_btn_cancel,keys:["esc"]}};return{title:wpforms_upgrade.upgrd_to_pro_license_ok_title,content:wpforms_upgrade.upgrd_to_pro_license_ok_msg,icon:"fa fa-check-circle",type:"green",buttons:n}},licenseVerifyError:function(e){return{title:wpforms_upgrade.error,content:e.data,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_admin.ok,btnClass:"btn-confirm",keys:["enter"]}}}},proAlreadyInstalled:function(e){var n={confirm:{text:wpforms_upgrade.upgrd_to_pro_btn_ok,btnClass:"btn-confirm",keys:["enter"],action:function(){r.location=r.location}}};return{title:wpforms_upgrade.upgrd_to_pro_license_ok_title,content:e.data.message,icon:"fa fa-check-circle",type:"green",buttons:n}},gotoUpgradeUrl:function(){var e={action:"wpforms_get_upgrade_url",nonce:wpforms_admin.nonce};t.post(wpforms_admin.ajax_url,e).done(function(e){if(e.success)return e.data.reload?void t.alert(o.proAlreadyInstalled(e)):void(r.location.href=e.data.url);t.alert({title:wpforms_upgrade.error,content:e.data.message,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_admin.ok,btnClass:"btn-confirm",keys:["enter"]}}})}).fail(function(e){o.failAlert(e)})},failAlert:function(e){console.log(e),t.alert({title:wpforms_upgrade.error,content:wpforms_upgrade.error_intro+" "+e.status+" "+e.statusText+" "+e.responseText,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_admin.ok,btnClass:"btn-confirm",keys:["enter"]}}})}};return o}(document,window,jQuery);WPFormsUpgrade.init();